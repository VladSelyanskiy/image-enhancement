# image-enhancement

## Описание

Проект представляет собой приложение для улучшения качества изображений с использованием библиотеки OpenCV. Приложение имеет графический интерфейс на PyQt6 и предоставляет возможность применения различных алгоритмов обработки изображений:

- **Удаление шума** - медианное размытие для обычных изображений
- **Удаление шума для бинарных изображений** - морфологические операции (открытие/закрытие)
- **Эквализация гистограммы** - глобальная или адаптивная эквализация для улучшения контраста
- **Увеличение контраста** - CLAHE (Contrast Limited Adaptive Histogram Equalization)

Приложение поддерживает настройку параметров обработки через удобный интерфейс настроек, включая изменение разрешения, уровней редукции шума и параметров контраста.

## Установка и запуск

1. **Убедитесь, что установлен Python 3.12 или выше:**
   ```bash
   python --version
   ```

2. **Установите зависимости из requirements.txt:**
   ```bash
   pip install -r requirements.txt
   ```
   
   Или используйте Poetry (если установлен):
   ```bash
   poetry install
   ```

3. **Запустите приложение:**
   ```bash
   python main.py
   ```

## Использование

### Основной сценарий использования 1: Удаление шума

1. Запустите приложение
2. Перейдите на вкладку "Image"
3. Нажмите "Load Image" и выберите изображение для обработки
4. В выпадающем списке "Quick selection" выберите "Remove noise"
5. При необходимости настройте параметры на вкладке "Settings":
   - Уровень редукции для обычных случаев (1-13)
   - Разрешение изображения (опционально)
6. Нажмите "Process Image"
7. Результат обработки отобразится в новом окне OpenCV

### Основной сценарий использования 2: Улучшение контраста

1. Загрузите изображение через "Load Image"
2. Выберите "Increase image contrast" в выпадающем списке
3. Перейдите на вкладку "Settings" и настройте:
   - Уровень контраста (1-10) в группе "Contrast"
4. Нажмите "Process Image" для применения CLAHE-фильтра
5. Обработанное изображение появится в отдельном окне

### Обработка бинарных изображений

1. Загрузите бинарное изображение
2. Выберите "Remove noise (for binary)" в списке операций
3. В настройках выберите тип обработки:
   - **Opening** - для удаления шума (рекомендуется для мелких артефактов)
   - **Closing** - для заполнения отверстий (рекомендуется для дырок в объектах)
4. Настройте уровень редукции для бинарных случаев (1-13)
5. Обработайте изображение

### Эквализация гистограммы

1. Выберите "Make Equalization"
2. В настройках выберите тип эквализации:
   - **Global** - глобальная эквализация (подходит для изображений с низким контрастом)
   - **Adaptive** - адаптивная эквализация CLAHE (подходит для изображений с яркими участками)
3. Обработайте изображение

## Структура проекта

```
image-enhancement/
├── main.py              # Точка входа в приложение, запускает GUI
├── gui.py               # Графический интерфейс на PyQt6
│                         # - ImageTab: вкладка для работы с изображениями
│                         # - SettingsTab: вкладка с настройками обработки
│                         # - MainWindow: главное окно приложения
├── core.py              # Ядро обработки изображений
│                         # - ImageHandler: класс для применения различных фильтров
├── requirements.txt     # Список зависимостей Python
├── pyproject.toml       # Конфигурация проекта Poetry
├── utils/               # Вспомогательные файлы и примеры изображений
└── README.md           # Документация проекта
```

### Ключевые файлы:

- **main.py** - запускает приложение PyQt6 и отображает главное окно
- **gui.py** - содержит весь код GUI:
  - `ImageTab` - управление загрузкой и обработкой изображений
  - `SettingsTab` - панель настроек с методами доступа к параметрам
  - `MainWindow` - главное окно с вкладками
- **core.py** - содержит класс `ImageHandler` с методами обработки:
  - `makeMedianBlur()` - медианное размытие
  - `delNoiseBinary()` - морфологические операции для бинарных изображений
  - `makeEqualization()` - эквализация гистограммы
  - `applyClahe()` - адаптивная эквализация с ограничением контраста

## Требования

- **Python 3.12+** (указано в pyproject.toml)
- **Зависимости:**
  - `numpy==2.2.6` - работа с массивами данных
  - `opencv-python==4.12.0.88` - обработка изображений
  - `PyQt6==6.10.1` - графический интерфейс
  - `PyQt6-Qt6==6.10.1` - базовые компоненты PyQt6
  - `PyQt6_sip==13.10.3` - привязки Python для PyQt6

Все зависимости можно установить командой:
```bash
pip install -r requirements.txt
```

## Конфигурация

Настройки приложения находятся на вкладке "Settings" и включают:

### Настройки изображения (Image Settings):
- **Use specific resolution** - включение/отключение изменения разрешения
- **Height** - высота изображения (100-2000, по умолчанию 800)
- **Weight** - ширина изображения (100-2000, по умолчанию 800)

### Настройки обработки (Processing Settings):

**Reduction (Редукция шума):**
- **Level of reduction for common cases** - уровень для обычных изображений (1-13, по умолчанию 5)
- **Level of reduction for binary cases** - уровень для бинарных изображений (1-13, по умолчанию 5)

**Type of binary processing:**
- **Opening** - операция открытия (удаление шума)
- **Closing** - операция закрытия (заполнение отверстий)

**Type of equalization:**
- **Global** - глобальная эквализация
- **Adaptive** - адаптивная эквализация (CLAHE)

**Contrast:**
- **Contrast enhancement level** - уровень усиления контраста (1-10, по умолчанию 3)

Все настройки применяются автоматически при обработке изображения через метод `SettingsTab.toDict()`, который передает параметры в `ImageHandler`.

## Разработка и расширение

### Добавление нового метода обработки изображений

1. **Добавьте метод в `ImageHandler` (core.py):**
   ```python
   def newProcessingMethod(self, show: bool = True) -> MatLike:
       # Ваш код обработки
       processed_image = ...
       if show:
           cv2.imshow("result", processed_image)
           cv2.waitKey(0)
           cv2.destroyAllWindows()
       return processed_image
   ```

2. **Добавьте пункт в выпадающий список ImageTab:**
   ```python
   self.choice.addItem("New Processing Method")
   ```

3. **Добавьте обработку в метод `capture_image`:**
   ```python
   if index == 4:  # следующий индекс
       handler.newProcessingMethod()
   ```

### Добавление новых настроек

1. **Добавьте виджет в `SettingsTab.create_processing_settings()` или `create_image_settings()`**

2. **Обновите метод `toDict()` для передачи нового параметра:**
   ```python
   def toDict(self) -> Dict[str, Any]:
       return {
           # ... существующие параметры
           "new_setting": self.new_widget.value(),
       }
   ```

3. **Добавьте параметр в `ImageHandler.__init__()` и используйте в методах обработки**

### Модификация существующих алгоритмов

Все методы обработки в `ImageHandler` используют параметры, переданные при инициализации через `**self.settings_tab.toDict()`. Для изменения логики алгоритма отредактируйте соответствующий метод в `core.py`.

### Архитектурные заметки

- `ImageTab` получает ссылку на `SettingsTab` при создании для доступа к настройкам
- `ImageHandler` получает все параметры через конструктор, что делает класс более тестируемым
- Все методы обработки поддерживают опциональное отображение результата через параметр `show`